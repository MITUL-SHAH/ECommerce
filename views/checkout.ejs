<!DOCTYPE html>
<html>
    <head>
        <meta charset="ISO-8859-1">
        <title>CheckOut</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet"
            integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.25/css/dataTables.bootstrap5.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    </head>
<body align="center">
    <br> <br>
    <h1 class="text-primary text-center mx-auto">CheckOut Items</h1>
    
    <form action="#" method="post" name="checkout">
        <table class="table table-bordered">
            <thead>
                <tr class="table-primary">
                    <th class="text-center">Item Name</th>
                    <th class="text-center">Quantity (qty)</th>
                    <th class="text-center">Per Item cost</th>
                    <th class="text-center">Total Cost</th>
                </tr>
            </thead>
            <tbody id="dynamicTable">
                        <!-- Table rows will be added here -->
            </tbody>
        </table>
        <!-- align table left -->
        <table class="table table-bordered" style="float: right; width: 50%;">
                <tr>
                    <td colspan="3" class="text-center" style="font-weight: bold;">Total Cost</td>
                    <td class="text-center" style="font-weight: bold;"><%- TotalPrice %></td>
                </tr>
                <tr>
                    <td colspan="3" class="text-center" style="font-weight: bold;">promo code</td>
                    <td class="text-center" style="font-weight: bold;"><%- Promocode %></td>
                </tr>
                <tr>
                    <td colspan="3" class="text-center" style="font-weight: bold;">Sales Tax</td>
                    <td class="text-center" style="font-weight: bold;"><%- Sales %></td>
                </tr>
                <tr class="table-active">
                    <td colspan="3" class="text-center" style="font-weight: bold;">Total Cost</td>
                    <td class="text-center" style="font-weight: bold;"><%- FinalPrice %></td>
                </tr>
            </tbody>
        </table>


        <!-- Get CArd Detials -->
        <div class="form-group" id = "cardDetails">
            <input type="text" class="form-control" name="cardNumber" id="cardNumber" placeholder="Card Number"><br>
            <input type="text" class="form-control" name="cardName" id="cardName" placeholder="Name on Card"><br>
            <input type="text" class="form-control" name="cardExpiry" id="cardExpiry" placeholder="Expiry Date"><br>
            <input type="text" class="form-control" name="cardCVV" id="cardCVV" placeholder="CVV"><br>
        </div>
        
        <div class="col-md-3 text-center mx-auto">
            <button type="button" class="btn btn-primary align-self-center" onclick="window.location.href = '/orderplace';" id="checkout">CheckOut</button>
        </div>
    </form>
    <br> <br>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const dynamicTable = document.getElementById('dynamicTable');
            let rowCounter = 0;
    
            var cartDetails = <%= JSON.stringify(cartDetails) %>;
            cart_row_reference = [];
            for (const itemData of cartDetails) {
                rowCounter++;
                const newRow = document.createElement('tr');
                newRow.innerHTML = `
                    <tr>
                        <td class="w-25 text-center">
                            <label for="item${rowCounter}">${itemData.name}</label>
                        </td>
                        <td class="w-25 text-center">
                            <label for="item${rowCounter}">${itemData.quantity}</label>
                        </td>
                        <td class="w-25 text-center">
                            <label for="item${rowCounter}">${itemData.price}</label>
                        </td>
                        <td class="w-25 text-center">
                            <label for="item${rowCounter}">${itemData.totalPrice}</label>
                        </td>
                    <tr>
                `;
                dynamicTable.appendChild(newRow);
            }
    
            // const checkoutButton = document.getElementById('checkout');
            // checkoutButton.addEventListener('click', function () {
            //     // Redirect to the "orderplace.ejs" file
            //     window.location.href = '/orderplace.ejs';
            // });
        });
    </script>
        
</body>
</html>
